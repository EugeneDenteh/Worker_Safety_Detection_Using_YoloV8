{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "DsME4yMFnr06",
    "outputId": "cd272af0-3794-4baa-c83d-78240efab239"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "/content\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "HOME = os.getcwd()\n",
    "print(HOME)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "u5iDLbvlrRhv",
    "outputId": "47f33b0e-d489-4121-f4b8-577aad974e96"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Collecting ultralytics==8.0.20\n",
      "  Downloading ultralytics-8.0.20-py3-none-any.whl (261 kB)\n",
      "\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m261.2/261.2 kB\u001b[0m \u001b[31m5.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0ma \u001b[36m0:00:01\u001b[0m\n",
      "\u001b[?25hRequirement already satisfied: matplotlib>=3.2.2 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (3.7.1)\n",
      "Requirement already satisfied: numpy>=1.18.5 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (1.23.5)\n",
      "Requirement already satisfied: opencv-python>=4.6.0 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (4.8.0.76)\n",
      "Requirement already satisfied: Pillow>=7.1.2 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (9.4.0)\n",
      "Requirement already satisfied: PyYAML>=5.3.1 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (6.0.1)\n",
      "Requirement already satisfied: requests>=2.23.0 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (2.31.0)\n",
      "Requirement already satisfied: scipy>=1.4.1 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (1.11.3)\n",
      "Requirement already satisfied: torch>=1.7.0 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (2.1.0+cu118)\n",
      "Requirement already satisfied: torchvision>=0.8.1 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (0.16.0+cu118)\n",
      "Requirement already satisfied: tqdm>=4.64.0 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (4.66.1)\n",
      "Requirement already satisfied: tensorboard>=2.4.1 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (2.14.1)\n",
      "Requirement already satisfied: pandas>=1.1.4 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (1.5.3)\n",
      "Requirement already satisfied: seaborn>=0.11.0 in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (0.12.2)\n",
      "Requirement already satisfied: ipython in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (7.34.0)\n",
      "Requirement already satisfied: psutil in /usr/local/lib/python3.10/dist-packages (from ultralytics==8.0.20) (5.9.5)\n",
      "Collecting thop>=0.1.1 (from ultralytics==8.0.20)\n",
      "  Downloading thop-0.1.1.post2209072238-py3-none-any.whl (15 kB)\n",
      "Collecting sentry-sdk (from ultralytics==8.0.20)\n",
      "  Downloading sentry_sdk-1.32.0-py2.py3-none-any.whl (240 kB)\n",
      "\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m241.0/241.0 kB\u001b[0m \u001b[31m29.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
      "\u001b[?25hRequirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics==8.0.20) (1.1.1)\n",
      "Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics==8.0.20) (0.12.1)\n",
      "Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics==8.0.20) (4.43.1)\n",
      "Requirement already satisfied: kiwisolver>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics==8.0.20) (1.4.5)\n",
      "Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics==8.0.20) (23.2)\n",
      "Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics==8.0.20) (3.1.1)\n",
      "Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib>=3.2.2->ultralytics==8.0.20) (2.8.2)\n",
      "Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas>=1.1.4->ultralytics==8.0.20) (2023.3.post1)\n",
      "Requirement already satisfied: charset-normalizer<4,>=2 in /usr/local/lib/python3.10/dist-packages (from requests>=2.23.0->ultralytics==8.0.20) (3.3.0)\n",
      "Requirement already satisfied: idna<4,>=2.5 in /usr/local/lib/python3.10/dist-packages (from requests>=2.23.0->ultralytics==8.0.20) (3.4)\n",
      "Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests>=2.23.0->ultralytics==8.0.20) (2.0.7)\n",
      "Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests>=2.23.0->ultralytics==8.0.20) (2023.7.22)\n",
      "Requirement already satisfied: absl-py>=0.4 in /usr/local/lib/python3.10/dist-packages (from tensorboard>=2.4.1->ultralytics==8.0.20) (1.4.0)\n",
      "Requirement already satisfied: grpcio>=1.48.2 in /usr/local/lib/python3.10/dist-packages (from tensorboard>=2.4.1->ultralytics==8.0.20) (1.59.0)\n",
      "Requirement already satisfied: google-auth<3,>=1.6.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard>=2.4.1->ultralytics==8.0.20) (2.17.3)\n",
      "Requirement already satisfied: google-auth-oauthlib<1.1,>=0.5 in /usr/local/lib/python3.10/dist-packages (from tensorboard>=2.4.1->ultralytics==8.0.20) (1.0.0)\n",
      "Requirement already satisfied: markdown>=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard>=2.4.1->ultralytics==8.0.20) (3.5)\n",
      "Requirement already satisfied: protobuf>=3.19.6 in /usr/local/lib/python3.10/dist-packages (from tensorboard>=2.4.1->ultralytics==8.0.20) (3.20.3)\n",
      "Requirement already satisfied: setuptools>=41.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard>=2.4.1->ultralytics==8.0.20) (67.7.2)\n",
      "Requirement already satisfied: six>1.9 in /usr/local/lib/python3.10/dist-packages (from tensorboard>=2.4.1->ultralytics==8.0.20) (1.16.0)\n",
      "Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard>=2.4.1->ultralytics==8.0.20) (0.7.1)\n",
      "Requirement already satisfied: werkzeug>=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard>=2.4.1->ultralytics==8.0.20) (3.0.0)\n",
      "Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics==8.0.20) (3.12.4)\n",
      "Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics==8.0.20) (4.5.0)\n",
      "Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics==8.0.20) (1.12)\n",
      "Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics==8.0.20) (3.2)\n",
      "Requirement already satisfied: jinja2 in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics==8.0.20) (3.1.2)\n",
      "Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics==8.0.20) (2023.6.0)\n",
      "Requirement already satisfied: triton==2.1.0 in /usr/local/lib/python3.10/dist-packages (from torch>=1.7.0->ultralytics==8.0.20) (2.1.0)\n",
      "Collecting jedi>=0.16 (from ipython->ultralytics==8.0.20)\n",
      "  Downloading jedi-0.19.1-py2.py3-none-any.whl (1.6 MB)\n",
      "\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m1.6/1.6 MB\u001b[0m \u001b[31m67.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n",
      "\u001b[?25hRequirement already satisfied: decorator in /usr/local/lib/python3.10/dist-packages (from ipython->ultralytics==8.0.20) (4.4.2)\n",
      "Requirement already satisfied: pickleshare in /usr/local/lib/python3.10/dist-packages (from ipython->ultralytics==8.0.20) (0.7.5)\n",
      "Requirement already satisfied: traitlets>=4.2 in /usr/local/lib/python3.10/dist-packages (from ipython->ultralytics==8.0.20) (5.7.1)\n",
      "Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from ipython->ultralytics==8.0.20) (3.0.39)\n",
      "Requirement already satisfied: pygments in /usr/local/lib/python3.10/dist-packages (from ipython->ultralytics==8.0.20) (2.16.1)\n",
      "Requirement already satisfied: backcall in /usr/local/lib/python3.10/dist-packages (from ipython->ultralytics==8.0.20) (0.2.0)\n",
      "Requirement already satisfied: matplotlib-inline in /usr/local/lib/python3.10/dist-packages (from ipython->ultralytics==8.0.20) (0.1.6)\n",
      "Requirement already satisfied: pexpect>4.3 in /usr/local/lib/python3.10/dist-packages (from ipython->ultralytics==8.0.20) (4.8.0)\n",
      "Requirement already satisfied: cachetools<6.0,>=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard>=2.4.1->ultralytics==8.0.20) (5.3.1)\n",
      "Requirement already satisfied: pyasn1-modules>=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard>=2.4.1->ultralytics==8.0.20) (0.3.0)\n",
      "Requirement already satisfied: rsa<5,>=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth<3,>=1.6.3->tensorboard>=2.4.1->ultralytics==8.0.20) (4.9)\n",
      "Requirement already satisfied: requests-oauthlib>=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib<1.1,>=0.5->tensorboard>=2.4.1->ultralytics==8.0.20) (1.3.1)\n",
      "Requirement already satisfied: parso<0.9.0,>=0.8.3 in /usr/local/lib/python3.10/dist-packages (from jedi>=0.16->ipython->ultralytics==8.0.20) (0.8.3)\n",
      "Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.10/dist-packages (from pexpect>4.3->ipython->ultralytics==8.0.20) (0.7.0)\n",
      "Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0->ipython->ultralytics==8.0.20) (0.2.8)\n",
      "Requirement already satisfied: MarkupSafe>=2.1.1 in /usr/local/lib/python3.10/dist-packages (from werkzeug>=1.0.1->tensorboard>=2.4.1->ultralytics==8.0.20) (2.1.3)\n",
      "Requirement already satisfied: mpmath>=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy->torch>=1.7.0->ultralytics==8.0.20) (1.3.0)\n",
      "Requirement already satisfied: pyasn1<0.6.0,>=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules>=0.2.1->google-auth<3,>=1.6.3->tensorboard>=2.4.1->ultralytics==8.0.20) (0.5.0)\n",
      "Requirement already satisfied: oauthlib>=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib>=0.7.0->google-auth-oauthlib<1.1,>=0.5->tensorboard>=2.4.1->ultralytics==8.0.20) (3.2.2)\n",
      "Installing collected packages: sentry-sdk, jedi, thop, ultralytics\n",
      "Successfully installed jedi-0.19.1 sentry-sdk-1.32.0 thop-0.1.1.post2209072238 ultralytics-8.0.20\n"
     ]
    }
   ],
   "source": [
    "!pip install ultralytics==8.0.20"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "bezuAaHBsc8D",
    "outputId": "5fce3d8f-72f1-4d83-8975-73eb7db535cc"
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Ultralytics YOLOv8.0.20 ðŸš€ Python-3.10.12 torch-2.1.0+cu118 CUDA:0 (Tesla T4, 15102MiB)\n",
      "Setup complete âœ… (2 CPUs, 12.7 GB RAM, 27.1/78.2 GB disk)\n"
     ]
    }
   ],
   "source": [
    "import ultralytics\n",
    "ultralytics.checks()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "Xu4-tU-svaeq"
   },
   "outputs": [],
   "source": [
    "!apt install unzip\n",
    "!unzip -u '/content/drive/MyDrive/Worker safety detection.zip' -d '/content/drive/MyDrive/Worker safety Data'"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "dKqwReFpseVk",
    "outputId": "4905f40d-ede7-411a-9c3d-8e2462ed2f69"
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Ultralytics YOLOv8.0.20 ðŸš€ Python-3.10.12 torch-2.1.0+cu118 CUDA:0 (Tesla T4, 15102MiB)\n",
      "\u001b[34m\u001b[1myolo/engine/trainer: \u001b[0mtask=detect, mode=train, model=yolov8n.yaml, data=/content/drive/MyDrive/Worker_safety_Data/safety.yaml, epochs=50, patience=10, batch=16, imgsz=640, save=True, cache=False, device=, workers=8, project=None, name=None, exist_ok=False, pretrained=False, optimizer=SGD, verbose=True, seed=0, deterministic=True, single_cls=False, image_weights=False, rect=False, cos_lr=False, close_mosaic=10, resume=False, overlap_mask=True, mask_ratio=4, dropout=False, val=True, save_json=False, save_hybrid=False, conf=0.001, iou=0.7, max_det=300, half=False, dnn=False, plots=True, source=ultralytics/assets/, show=False, save_txt=False, save_conf=False, save_crop=False, hide_labels=False, hide_conf=False, vid_stride=1, line_thickness=3, visualize=False, augment=False, agnostic_nms=False, classes=None, retina_masks=False, boxes=True, format=torchscript, keras=False, optimize=False, int8=False, dynamic=False, simplify=False, opset=17, workspace=4, nms=False, lr0=0.01, lrf=0.01, momentum=0.937, weight_decay=0.001, warmup_epochs=3.0, warmup_momentum=0.8, warmup_bias_lr=0.1, box=7.5, cls=0.5, dfl=1.5, fl_gamma=0.0, label_smoothing=0.0, nbs=64, hsv_h=0.015, hsv_s=0.7, hsv_v=0.4, degrees=0.0, translate=0.1, scale=0.5, shear=0.0, perspective=0.0, flipud=0.0, fliplr=0.5, mosaic=1.0, mixup=0.0, copy_paste=0.0, cfg=None, v5loader=False, save_dir=runs/detect/train\n",
      "Downloading https://ultralytics.com/assets/Arial.ttf to /root/.config/Ultralytics/Arial.ttf...\n",
      "100% 755k/755k [00:00<00:00, 15.3MB/s]\n",
      "2023-10-24 14:50:32.817034: E tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:9342] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n",
      "2023-10-24 14:50:32.817095: E tensorflow/compiler/xla/stream_executor/cuda/cuda_fft.cc:609] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n",
      "2023-10-24 14:50:32.817141: E tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:1518] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n",
      "2023-10-24 14:50:32.831916: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.\n",
      "To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.\n",
      "2023-10-24 14:50:34.201619: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT\n",
      "Overriding model.yaml nc=80 with nc=10\n",
      "\n",
      "                   from  n    params  module                                       arguments                     \n",
      "  0                  -1  1       464  ultralytics.nn.modules.Conv                  [3, 16, 3, 2]                 \n",
      "  1                  -1  1      4672  ultralytics.nn.modules.Conv                  [16, 32, 3, 2]                \n",
      "  2                  -1  1      7360  ultralytics.nn.modules.C2f                   [32, 32, 1, True]             \n",
      "  3                  -1  1     18560  ultralytics.nn.modules.Conv                  [32, 64, 3, 2]                \n",
      "  4                  -1  2     49664  ultralytics.nn.modules.C2f                   [64, 64, 2, True]             \n",
      "  5                  -1  1     73984  ultralytics.nn.modules.Conv                  [64, 128, 3, 2]               \n",
      "  6                  -1  2    197632  ultralytics.nn.modules.C2f                   [128, 128, 2, True]           \n",
      "  7                  -1  1    295424  ultralytics.nn.modules.Conv                  [128, 256, 3, 2]              \n",
      "  8                  -1  1    460288  ultralytics.nn.modules.C2f                   [256, 256, 1, True]           \n",
      "  9                  -1  1    164608  ultralytics.nn.modules.SPPF                  [256, 256, 5]                 \n",
      " 10                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']          \n",
      " 11             [-1, 6]  1         0  ultralytics.nn.modules.Concat                [1]                           \n",
      " 12                  -1  1    148224  ultralytics.nn.modules.C2f                   [384, 128, 1]                 \n",
      " 13                  -1  1         0  torch.nn.modules.upsampling.Upsample         [None, 2, 'nearest']          \n",
      " 14             [-1, 4]  1         0  ultralytics.nn.modules.Concat                [1]                           \n",
      " 15                  -1  1     37248  ultralytics.nn.modules.C2f                   [192, 64, 1]                  \n",
      " 16                  -1  1     36992  ultralytics.nn.modules.Conv                  [64, 64, 3, 2]                \n",
      " 17            [-1, 12]  1         0  ultralytics.nn.modules.Concat                [1]                           \n",
      " 18                  -1  1    123648  ultralytics.nn.modules.C2f                   [192, 128, 1]                 \n",
      " 19                  -1  1    147712  ultralytics.nn.modules.Conv                  [128, 128, 3, 2]              \n",
      " 20             [-1, 9]  1         0  ultralytics.nn.modules.Concat                [1]                           \n",
      " 21                  -1  1    493056  ultralytics.nn.modules.C2f                   [384, 256, 1]                 \n",
      " 22        [15, 18, 21]  1    753262  ultralytics.nn.modules.Detect                [10, [64, 128, 256]]          \n",
      "Model summary: 225 layers, 3012798 parameters, 3012782 gradients, 8.2 GFLOPs\n",
      "\n",
      "Transferred 319/355 items from pretrained weights\n",
      "\u001b[34m\u001b[1moptimizer:\u001b[0m SGD(lr=0.01) with parameter groups 57 weight(decay=0.0), 64 weight(decay=0.001), 63 bias\n",
      "\u001b[34m\u001b[1mtrain: \u001b[0mScanning /content/drive/MyDrive/Worker_safety_Data/Worker_safety_detection/train/labels.cache... 2605 images, 6 backgrounds, 0 corrupt: 100% 2605/2605 [00:00<?, ?it/s]\n",
      "\u001b[34m\u001b[1mtrain: \u001b[0mWARNING âš ï¸ /content/drive/MyDrive/Worker_safety_Data/Worker_safety_detection/train/images/004720_jpg.rf.afc486560a4004c7cfd67910af31a29c.jpg: 1 duplicate labels removed\n",
      "\u001b[34m\u001b[1mtrain: \u001b[0mWARNING âš ï¸ /content/drive/MyDrive/Worker_safety_Data/Worker_safety_detection/train/images/construction-813-_jpg.rf.b085952261fd98f2e76b8065de149b5f.jpg: 1 duplicate labels removed\n",
      "\u001b[34m\u001b[1malbumentations: \u001b[0mBlur(p=0.01, blur_limit=(3, 7)), MedianBlur(p=0.01, blur_limit=(3, 7)), ToGray(p=0.01), CLAHE(p=0.01, clip_limit=(1, 4.0), tile_grid_size=(8, 8))\n",
      "\u001b[34m\u001b[1mval: \u001b[0mScanning /content/drive/MyDrive/Worker_safety_Data/Worker_safety_detection/valid/labels.cache... 114 images, 10 backgrounds, 0 corrupt: 100% 114/114 [00:00<?, ?it/s]\n",
      "Image sizes 640 train, 640 val\n",
      "Using 2 dataloader workers\n",
      "Logging results to \u001b[1mruns/detect/train\u001b[0m\n",
      "Starting training for 50 epochs...\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "       1/50      9.62G      1.367       3.05      1.448        477        640: 100% 163/163 [02:57<00:00,  1.09s/it]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:19<00:00,  4.76s/it]\n",
      "                   all        114        697      0.362      0.239      0.213     0.0965\n",
      "               Hardhat        114         79      0.502      0.509       0.44      0.233\n",
      "                  Mask        114         21     0.0688     0.0476     0.0492      0.017\n",
      "            NO-Hardhat        114         69      0.158      0.101     0.0764     0.0273\n",
      "               NO-Mask        114         74          0          0     0.0717     0.0244\n",
      "        NO-Safety Vest        114        106      0.266     0.0943      0.122     0.0484\n",
      "                Person        114        166       0.52      0.452      0.424      0.175\n",
      "           Safety Cone        114         44      0.408       0.25      0.214        0.1\n",
      "           Safety Vest        114         41      0.303      0.415       0.33       0.13\n",
      "             machinery        114         55      0.396      0.525      0.391      0.204\n",
      "               vehicle        114         42          1          0     0.0168    0.00548\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "       2/50        11G      1.296      2.022      1.401        296        640: 100% 163/163 [02:23<00:00,  1.13it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:03<00:00,  1.12it/s]\n",
      "                   all        114        697      0.517      0.369      0.388      0.172\n",
      "               Hardhat        114         79      0.748      0.557      0.613      0.327\n",
      "                  Mask        114         21      0.625      0.333      0.409       0.21\n",
      "            NO-Hardhat        114         69      0.723      0.188       0.33      0.103\n",
      "               NO-Mask        114         74      0.395      0.243      0.208     0.0884\n",
      "        NO-Safety Vest        114        106      0.648      0.151      0.308      0.126\n",
      "                Person        114        166      0.578      0.506      0.521      0.226\n",
      "           Safety Cone        114         44      0.424      0.523      0.487      0.168\n",
      "           Safety Vest        114         41      0.456      0.488       0.45       0.19\n",
      "             machinery        114         55      0.222      0.491      0.326      0.177\n",
      "               vehicle        114         42      0.353      0.214      0.231      0.106\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "       3/50        11G      1.277      1.846      1.405        325        640: 100% 163/163 [02:19<00:00,  1.17it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.66it/s]\n",
      "                   all        114        697      0.473      0.375      0.359      0.142\n",
      "               Hardhat        114         79       0.84      0.466      0.533      0.277\n",
      "                  Mask        114         21      0.591      0.619      0.515      0.164\n",
      "            NO-Hardhat        114         69      0.535      0.217      0.214     0.0571\n",
      "               NO-Mask        114         74      0.472      0.203      0.232     0.0996\n",
      "        NO-Safety Vest        114        106      0.194      0.236      0.139     0.0559\n",
      "                Person        114        166      0.452      0.446      0.407      0.155\n",
      "           Safety Cone        114         44      0.595      0.455      0.559       0.21\n",
      "           Safety Vest        114         41      0.497      0.458      0.512      0.169\n",
      "             machinery        114         55      0.201      0.473      0.306      0.131\n",
      "               vehicle        114         42      0.349      0.179      0.179     0.0986\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "       4/50        11G      1.299      1.801      1.421        325        640: 100% 163/163 [02:24<00:00,  1.13it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.58it/s]\n",
      "                   all        114        697      0.549      0.399      0.429       0.19\n",
      "               Hardhat        114         79      0.746      0.559      0.649       0.36\n",
      "                  Mask        114         21      0.527      0.619      0.662      0.344\n",
      "            NO-Hardhat        114         69       0.54      0.377      0.373      0.114\n",
      "               NO-Mask        114         74      0.612      0.257      0.305     0.0951\n",
      "        NO-Safety Vest        114        106      0.338      0.265      0.224     0.0944\n",
      "                Person        114        166       0.54      0.512      0.501      0.208\n",
      "           Safety Cone        114         44      0.588      0.705      0.695      0.301\n",
      "           Safety Vest        114         41      0.696      0.293      0.381      0.181\n",
      "             machinery        114         55      0.294      0.334      0.299      0.116\n",
      "               vehicle        114         42      0.603     0.0714      0.204     0.0892\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "       5/50        11G      1.272      1.696      1.396        246        640: 100% 163/163 [02:27<00:00,  1.10it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.64it/s]\n",
      "                   all        114        697      0.605       0.45      0.471       0.21\n",
      "               Hardhat        114         79       0.79       0.62      0.679      0.386\n",
      "                  Mask        114         21      0.817      0.524      0.705      0.353\n",
      "            NO-Hardhat        114         69      0.665      0.377      0.403      0.145\n",
      "               NO-Mask        114         74      0.654      0.307      0.336      0.124\n",
      "        NO-Safety Vest        114        106      0.389      0.358      0.271      0.108\n",
      "                Person        114        166      0.597      0.566      0.535      0.198\n",
      "           Safety Cone        114         44      0.586      0.523      0.571      0.246\n",
      "           Safety Vest        114         41      0.642      0.438      0.438      0.211\n",
      "             machinery        114         55      0.517      0.509      0.513      0.221\n",
      "               vehicle        114         42       0.39      0.274      0.261      0.106\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "       6/50        11G      1.243      1.598      1.374        404        640: 100% 163/163 [02:25<00:00,  1.12it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.70it/s]\n",
      "                   all        114        697      0.681      0.477      0.527      0.243\n",
      "               Hardhat        114         79      0.864      0.482      0.652      0.377\n",
      "                  Mask        114         21       0.79      0.716      0.758      0.326\n",
      "            NO-Hardhat        114         69      0.681       0.42      0.435       0.17\n",
      "               NO-Mask        114         74      0.635      0.329      0.365      0.135\n",
      "        NO-Safety Vest        114        106      0.724       0.33      0.399      0.187\n",
      "                Person        114        166      0.767      0.577      0.649      0.303\n",
      "           Safety Cone        114         44      0.624      0.659      0.643      0.221\n",
      "           Safety Vest        114         41      0.827      0.581      0.641      0.345\n",
      "             machinery        114         55      0.505        0.4      0.465      0.238\n",
      "               vehicle        114         42      0.391      0.275       0.26      0.124\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "       7/50      12.7G      1.228      1.521       1.35        356        640: 100% 163/163 [02:21<00:00,  1.15it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:03<00:00,  1.15it/s]\n",
      "                   all        114        697      0.616      0.468      0.513      0.235\n",
      "               Hardhat        114         79      0.744       0.62      0.664      0.416\n",
      "                  Mask        114         21      0.727      0.619       0.71      0.252\n",
      "            NO-Hardhat        114         69      0.596      0.261      0.365      0.137\n",
      "               NO-Mask        114         74      0.501      0.351      0.364       0.15\n",
      "        NO-Safety Vest        114        106        0.7      0.309       0.42      0.179\n",
      "                Person        114        166      0.694      0.476      0.561      0.237\n",
      "           Safety Cone        114         44      0.712      0.591      0.614      0.269\n",
      "           Safety Vest        114         41      0.647      0.491      0.598        0.3\n",
      "             machinery        114         55      0.466        0.6      0.565      0.285\n",
      "               vehicle        114         42      0.377      0.357      0.269      0.128\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "       8/50      12.7G      1.218      1.515      1.358        268        640: 100% 163/163 [02:24<00:00,  1.13it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.74it/s]\n",
      "                   all        114        697      0.658      0.513      0.553      0.251\n",
      "               Hardhat        114         79      0.872      0.517      0.683      0.408\n",
      "                  Mask        114         21      0.536      0.714       0.67      0.246\n",
      "            NO-Hardhat        114         69      0.631      0.421      0.411      0.142\n",
      "               NO-Mask        114         74      0.582      0.338      0.376      0.142\n",
      "        NO-Safety Vest        114        106      0.663      0.391      0.449      0.168\n",
      "                Person        114        166       0.77      0.518      0.617      0.301\n",
      "           Safety Cone        114         44       0.68      0.773      0.734      0.356\n",
      "           Safety Vest        114         41      0.522      0.659      0.644      0.334\n",
      "             machinery        114         55      0.809      0.564      0.654      0.291\n",
      "               vehicle        114         42       0.52      0.232      0.289      0.121\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "       9/50      12.7G      1.196      1.463       1.34        441        640: 100% 163/163 [02:23<00:00,  1.14it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.82it/s]\n",
      "                   all        114        697      0.651      0.524       0.56      0.273\n",
      "               Hardhat        114         79      0.899      0.557        0.7      0.379\n",
      "                  Mask        114         21      0.882      0.714      0.801      0.456\n",
      "            NO-Hardhat        114         69      0.625       0.42      0.483      0.184\n",
      "               NO-Mask        114         74      0.614      0.432      0.443      0.206\n",
      "        NO-Safety Vest        114        106      0.514       0.38       0.37      0.161\n",
      "                Person        114        166      0.569       0.59      0.595      0.302\n",
      "           Safety Cone        114         44      0.752      0.659      0.701      0.334\n",
      "           Safety Vest        114         41      0.548      0.537      0.597      0.287\n",
      "             machinery        114         55      0.589      0.636      0.611      0.287\n",
      "               vehicle        114         42      0.515       0.31      0.303      0.135\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      10/50      12.7G      1.178      1.409      1.329        228        640: 100% 163/163 [02:20<00:00,  1.16it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.78it/s]\n",
      "                   all        114        697      0.633      0.561      0.581      0.245\n",
      "               Hardhat        114         79      0.943       0.63      0.727      0.396\n",
      "                  Mask        114         21      0.492      0.667      0.599      0.177\n",
      "            NO-Hardhat        114         69      0.569      0.478      0.466      0.173\n",
      "               NO-Mask        114         74       0.46      0.405      0.434      0.157\n",
      "        NO-Safety Vest        114        106      0.672      0.415      0.482      0.199\n",
      "                Person        114        166      0.704      0.645      0.661      0.252\n",
      "           Safety Cone        114         44      0.774      0.659      0.728      0.322\n",
      "           Safety Vest        114         41      0.752       0.61      0.668      0.308\n",
      "             machinery        114         55       0.49      0.745      0.661      0.273\n",
      "               vehicle        114         42      0.471      0.357      0.389      0.193\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      11/50      12.7G      1.163      1.372      1.317        296        640: 100% 163/163 [02:17<00:00,  1.18it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.84it/s]\n",
      "                   all        114        697      0.677      0.576      0.603      0.285\n",
      "               Hardhat        114         79       0.82      0.671      0.729      0.425\n",
      "                  Mask        114         21      0.949       0.81      0.856      0.435\n",
      "            NO-Hardhat        114         69      0.717      0.478      0.523      0.212\n",
      "               NO-Mask        114         74      0.659      0.459      0.491      0.195\n",
      "        NO-Safety Vest        114        106      0.592      0.472      0.489      0.208\n",
      "                Person        114        166      0.647      0.608      0.621      0.275\n",
      "           Safety Cone        114         44       0.75      0.683      0.737      0.333\n",
      "           Safety Vest        114         41      0.689      0.561      0.621      0.293\n",
      "             machinery        114         55      0.487      0.673      0.627      0.302\n",
      "               vehicle        114         42      0.459      0.344      0.338      0.172\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      12/50      12.7G      1.142      1.339      1.303        265        640: 100% 163/163 [02:17<00:00,  1.19it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.79it/s]\n",
      "                   all        114        697      0.769      0.561      0.633      0.312\n",
      "               Hardhat        114         79      0.925      0.622      0.727      0.433\n",
      "                  Mask        114         21      0.714      0.857      0.845      0.492\n",
      "            NO-Hardhat        114         69      0.731      0.513      0.563      0.199\n",
      "               NO-Mask        114         74      0.706      0.421      0.476      0.187\n",
      "        NO-Safety Vest        114        106      0.798      0.396      0.507      0.237\n",
      "                Person        114        166       0.76       0.59      0.673      0.298\n",
      "           Safety Cone        114         44      0.752      0.682       0.74      0.345\n",
      "           Safety Vest        114         41      0.866      0.631      0.723        0.4\n",
      "             machinery        114         55      0.714      0.636      0.721       0.34\n",
      "               vehicle        114         42      0.721      0.262      0.359      0.187\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      13/50      12.7G      1.139      1.311        1.3        249        640: 100% 163/163 [02:19<00:00,  1.17it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.84it/s]\n",
      "                   all        114        697      0.768      0.557       0.63       0.28\n",
      "               Hardhat        114         79      0.924      0.612      0.733      0.428\n",
      "                  Mask        114         21        0.8      0.762      0.793      0.326\n",
      "            NO-Hardhat        114         69      0.886      0.337      0.495      0.184\n",
      "               NO-Mask        114         74      0.786      0.397      0.483      0.187\n",
      "        NO-Safety Vest        114        106       0.68      0.453      0.509      0.205\n",
      "                Person        114        166      0.721      0.602      0.631      0.268\n",
      "           Safety Cone        114         44      0.829      0.773      0.833      0.387\n",
      "           Safety Vest        114         41      0.729      0.656      0.717      0.312\n",
      "             machinery        114         55       0.73      0.618      0.724      0.321\n",
      "               vehicle        114         42      0.594      0.357      0.378       0.18\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      14/50      12.7G      1.126      1.285      1.294        275        640: 100% 163/163 [02:16<00:00,  1.20it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.83it/s]\n",
      "                   all        114        697      0.777      0.573      0.632      0.322\n",
      "               Hardhat        114         79      0.903      0.591      0.705      0.445\n",
      "                  Mask        114         21      0.929       0.81      0.814      0.503\n",
      "            NO-Hardhat        114         69      0.762      0.522       0.54      0.226\n",
      "               NO-Mask        114         74      0.735      0.405       0.49        0.2\n",
      "        NO-Safety Vest        114        106      0.762      0.424      0.523      0.237\n",
      "                Person        114        166      0.778      0.596      0.642       0.34\n",
      "           Safety Cone        114         44      0.696      0.624      0.669      0.293\n",
      "           Safety Vest        114         41      0.867      0.638      0.742      0.366\n",
      "             machinery        114         55       0.71      0.764      0.765      0.401\n",
      "               vehicle        114         42      0.628      0.362      0.429      0.212\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      15/50      12.7G       1.11      1.246      1.281        299        640: 100% 163/163 [02:20<00:00,  1.16it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.79it/s]\n",
      "                   all        114        697      0.755      0.603      0.649      0.308\n",
      "               Hardhat        114         79      0.801      0.734      0.766      0.458\n",
      "                  Mask        114         21      0.924       0.81      0.809      0.386\n",
      "            NO-Hardhat        114         69      0.926      0.362       0.52      0.186\n",
      "               NO-Mask        114         74      0.769      0.419      0.525      0.217\n",
      "        NO-Safety Vest        114        106       0.68      0.443      0.533      0.207\n",
      "                Person        114        166      0.702      0.663      0.714      0.322\n",
      "           Safety Cone        114         44      0.862      0.711      0.814      0.373\n",
      "           Safety Vest        114         41      0.632      0.711      0.662      0.365\n",
      "             machinery        114         55       0.72      0.727      0.749      0.376\n",
      "               vehicle        114         42      0.533      0.452      0.404      0.193\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      16/50      12.7G      1.108      1.223      1.275        256        640: 100% 163/163 [02:25<00:00,  1.12it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.83it/s]\n",
      "                   all        114        697      0.793      0.571      0.643      0.323\n",
      "               Hardhat        114         79      0.911      0.646      0.749      0.458\n",
      "                  Mask        114         21      0.955       0.81      0.813      0.497\n",
      "            NO-Hardhat        114         69      0.722      0.451      0.456      0.193\n",
      "               NO-Mask        114         74      0.789      0.405       0.48      0.189\n",
      "        NO-Safety Vest        114        106      0.804      0.377      0.533      0.243\n",
      "                Person        114        166      0.812      0.596      0.684      0.324\n",
      "           Safety Cone        114         44      0.753      0.763      0.796      0.379\n",
      "           Safety Vest        114         41      0.818      0.657      0.735      0.352\n",
      "             machinery        114         55       0.72      0.673      0.754      0.395\n",
      "               vehicle        114         42      0.643      0.333      0.428        0.2\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      17/50      12.7G        1.1      1.209      1.268        314        640: 100% 163/163 [02:22<00:00,  1.15it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.70it/s]\n",
      "                   all        114        697      0.728      0.581      0.633      0.314\n",
      "               Hardhat        114         79      0.892      0.608      0.732      0.415\n",
      "                  Mask        114         21      0.833       0.81      0.815      0.459\n",
      "            NO-Hardhat        114         69      0.744      0.463      0.549       0.22\n",
      "               NO-Mask        114         74      0.688      0.405      0.457       0.19\n",
      "        NO-Safety Vest        114        106      0.797      0.472      0.568      0.254\n",
      "                Person        114        166      0.773      0.614      0.708      0.357\n",
      "           Safety Cone        114         44      0.685      0.693      0.717       0.34\n",
      "           Safety Vest        114         41       0.71      0.683        0.7      0.356\n",
      "             machinery        114         55      0.631        0.8      0.736      0.357\n",
      "               vehicle        114         42      0.524      0.262      0.345       0.19\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      18/50      12.7G      1.097      1.194      1.267        212        640: 100% 163/163 [02:21<00:00,  1.15it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.72it/s]\n",
      "                   all        114        697      0.774      0.619       0.67      0.341\n",
      "               Hardhat        114         79      0.843      0.658      0.745      0.439\n",
      "                  Mask        114         21      0.872      0.857      0.868      0.535\n",
      "            NO-Hardhat        114         69      0.597      0.493      0.529      0.244\n",
      "               NO-Mask        114         74      0.702      0.541      0.525      0.227\n",
      "        NO-Safety Vest        114        106      0.758      0.472       0.55      0.261\n",
      "                Person        114        166      0.779      0.639      0.696      0.359\n",
      "           Safety Cone        114         44      0.778      0.795      0.808      0.381\n",
      "           Safety Vest        114         41      0.693      0.756      0.728       0.35\n",
      "             machinery        114         55      0.899      0.647        0.8      0.406\n",
      "               vehicle        114         42      0.822      0.331      0.451      0.207\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      19/50      12.7G      1.077      1.154      1.255        257        640: 100% 163/163 [02:21<00:00,  1.15it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.77it/s]\n",
      "                   all        114        697      0.814      0.573      0.667      0.313\n",
      "               Hardhat        114         79      0.978      0.568      0.724       0.41\n",
      "                  Mask        114         21      0.854      0.762      0.778      0.345\n",
      "            NO-Hardhat        114         69      0.805       0.42       0.51      0.227\n",
      "               NO-Mask        114         74      0.874      0.376       0.53      0.227\n",
      "        NO-Safety Vest        114        106       0.82      0.377      0.571      0.247\n",
      "                Person        114        166      0.826      0.573      0.683      0.322\n",
      "           Safety Cone        114         44      0.726      0.864      0.848       0.36\n",
      "           Safety Vest        114         41      0.899       0.65      0.758      0.358\n",
      "             machinery        114         55      0.756      0.782      0.813      0.425\n",
      "               vehicle        114         42      0.603      0.362      0.453      0.208\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      20/50      12.7G      1.067      1.144      1.246        320        640: 100% 163/163 [02:15<00:00,  1.21it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.84it/s]\n",
      "                   all        114        697      0.755      0.611       0.67      0.336\n",
      "               Hardhat        114         79      0.852      0.655      0.761      0.422\n",
      "                  Mask        114         21      0.984       0.81      0.861      0.418\n",
      "            NO-Hardhat        114         69      0.808      0.493      0.561      0.193\n",
      "               NO-Mask        114         74      0.721      0.338      0.479      0.213\n",
      "        NO-Safety Vest        114        106      0.727      0.519       0.55      0.255\n",
      "                Person        114        166      0.763       0.59      0.683      0.395\n",
      "           Safety Cone        114         44      0.727      0.773      0.827      0.432\n",
      "           Safety Vest        114         41      0.646      0.712      0.741      0.408\n",
      "             machinery        114         55      0.667      0.818      0.782      0.398\n",
      "               vehicle        114         42      0.654      0.405      0.453      0.227\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      21/50      12.7G      1.058      1.119      1.237        281        640: 100% 163/163 [02:16<00:00,  1.19it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.82it/s]\n",
      "                   all        114        697      0.799      0.631      0.678      0.368\n",
      "               Hardhat        114         79      0.926      0.696      0.759      0.497\n",
      "                  Mask        114         21      0.936      0.857      0.861      0.512\n",
      "            NO-Hardhat        114         69      0.751      0.507       0.57      0.239\n",
      "               NO-Mask        114         74       0.79      0.458      0.492      0.223\n",
      "        NO-Safety Vest        114        106      0.741      0.557      0.588      0.282\n",
      "                Person        114        166      0.819      0.651      0.745      0.413\n",
      "           Safety Cone        114         44      0.855      0.806      0.816      0.418\n",
      "           Safety Vest        114         41      0.737      0.685      0.744      0.439\n",
      "             machinery        114         55      0.636      0.763      0.741       0.41\n",
      "               vehicle        114         42        0.8      0.333      0.466      0.251\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      22/50      12.7G      1.051      1.111      1.234        284        640: 100% 163/163 [02:19<00:00,  1.17it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.82it/s]\n",
      "                   all        114        697      0.822      0.628      0.688       0.36\n",
      "               Hardhat        114         79      0.945      0.654       0.77      0.467\n",
      "                  Mask        114         21      0.927       0.81      0.816      0.477\n",
      "            NO-Hardhat        114         69      0.842      0.541      0.589      0.213\n",
      "               NO-Mask        114         74      0.851      0.473      0.548      0.234\n",
      "        NO-Safety Vest        114        106      0.864      0.481      0.602      0.292\n",
      "                Person        114        166       0.83      0.639      0.721      0.377\n",
      "           Safety Cone        114         44      0.742      0.818      0.815      0.413\n",
      "           Safety Vest        114         41      0.812      0.737       0.78      0.433\n",
      "             machinery        114         55      0.719      0.745      0.776      0.454\n",
      "               vehicle        114         42      0.685      0.381      0.465      0.237\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      23/50      12.7G       1.04       1.08      1.221        283        640: 100% 163/163 [02:17<00:00,  1.19it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.84it/s]\n",
      "                   all        114        697      0.799      0.636      0.698      0.376\n",
      "               Hardhat        114         79      0.929      0.722      0.793      0.487\n",
      "                  Mask        114         21      0.873      0.857      0.862      0.451\n",
      "            NO-Hardhat        114         69      0.942      0.473      0.614      0.273\n",
      "               NO-Mask        114         74      0.791      0.527       0.58      0.248\n",
      "        NO-Safety Vest        114        106      0.769      0.502      0.609      0.317\n",
      "                Person        114        166      0.852      0.627      0.726      0.411\n",
      "           Safety Cone        114         44      0.751      0.773       0.76      0.396\n",
      "           Safety Vest        114         41      0.788      0.683      0.736      0.454\n",
      "             machinery        114         55      0.725      0.782      0.844      0.485\n",
      "               vehicle        114         42      0.573      0.415       0.46      0.237\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      24/50      12.7G      1.031      1.072      1.226        277        640: 100% 163/163 [02:17<00:00,  1.19it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.85it/s]\n",
      "                   all        114        697      0.827      0.642      0.714      0.388\n",
      "               Hardhat        114         79      0.911      0.709      0.777      0.482\n",
      "                  Mask        114         21      0.899      0.846      0.856      0.518\n",
      "            NO-Hardhat        114         69      0.804      0.534      0.627      0.296\n",
      "               NO-Mask        114         74      0.849      0.459      0.574      0.228\n",
      "        NO-Safety Vest        114        106      0.831      0.511      0.641       0.33\n",
      "                Person        114        166      0.837      0.693      0.759      0.409\n",
      "           Safety Cone        114         44      0.842      0.845      0.874      0.452\n",
      "           Safety Vest        114         41      0.779      0.707      0.756      0.422\n",
      "             machinery        114         55      0.809      0.782      0.836      0.475\n",
      "               vehicle        114         42      0.712      0.333      0.439      0.271\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      25/50      12.7G      1.034      1.051      1.216        212        640: 100% 163/163 [02:18<00:00,  1.18it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.83it/s]\n",
      "                   all        114        697      0.809      0.649      0.708       0.39\n",
      "               Hardhat        114         79      0.931      0.685      0.797      0.494\n",
      "                  Mask        114         21      0.839      0.857      0.858       0.55\n",
      "            NO-Hardhat        114         69      0.813      0.536       0.56      0.209\n",
      "               NO-Mask        114         74      0.823      0.514      0.578      0.263\n",
      "        NO-Safety Vest        114        106      0.763      0.566      0.637      0.332\n",
      "                Person        114        166       0.83      0.669      0.737      0.416\n",
      "           Safety Cone        114         44      0.833      0.841      0.856       0.43\n",
      "           Safety Vest        114         41      0.771      0.683      0.754      0.421\n",
      "             machinery        114         55      0.774       0.81      0.856      0.509\n",
      "               vehicle        114         42      0.711      0.333      0.445      0.282\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      26/50      12.7G      1.015      1.034       1.21        314        640: 100% 163/163 [02:16<00:00,  1.19it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.85it/s]\n",
      "                   all        114        697      0.846      0.636      0.712      0.391\n",
      "               Hardhat        114         79      0.888      0.703      0.806      0.475\n",
      "                  Mask        114         21      0.933       0.81      0.874      0.533\n",
      "            NO-Hardhat        114         69       0.92      0.497      0.606      0.284\n",
      "               NO-Mask        114         74       0.88      0.494      0.589      0.259\n",
      "        NO-Safety Vest        114        106      0.797       0.48      0.628       0.33\n",
      "                Person        114        166      0.865      0.687      0.765      0.404\n",
      "           Safety Cone        114         44      0.877      0.727      0.822       0.46\n",
      "           Safety Vest        114         41      0.819      0.732      0.701      0.394\n",
      "             machinery        114         55      0.762        0.8       0.83      0.499\n",
      "               vehicle        114         42      0.722      0.433      0.495      0.268\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      27/50      12.7G      1.018      1.029      1.213        281        640: 100% 163/163 [02:16<00:00,  1.19it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.83it/s]\n",
      "                   all        114        697      0.839      0.649      0.716      0.392\n",
      "               Hardhat        114         79      0.965      0.689      0.773      0.461\n",
      "                  Mask        114         21      0.959       0.81      0.854      0.538\n",
      "            NO-Hardhat        114         69      0.871      0.507      0.571      0.255\n",
      "               NO-Mask        114         74      0.798      0.595      0.599      0.266\n",
      "        NO-Safety Vest        114        106      0.839      0.491      0.647      0.329\n",
      "                Person        114        166      0.856      0.681      0.756      0.416\n",
      "           Safety Cone        114         44      0.824      0.854      0.869      0.454\n",
      "           Safety Vest        114         41      0.786      0.718      0.769      0.429\n",
      "             machinery        114         55      0.758      0.818      0.823      0.505\n",
      "               vehicle        114         42      0.732      0.325      0.498      0.267\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      28/50      12.7G     0.9989      1.013      1.203        263        640: 100% 163/163 [02:20<00:00,  1.16it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.72it/s]\n",
      "                   all        114        697      0.816      0.659      0.714      0.394\n",
      "               Hardhat        114         79      0.945      0.709      0.796      0.496\n",
      "                  Mask        114         21      0.958       0.81      0.867      0.515\n",
      "            NO-Hardhat        114         69      0.858      0.524      0.615      0.273\n",
      "               NO-Mask        114         74      0.872      0.552      0.587      0.256\n",
      "        NO-Safety Vest        114        106      0.749      0.528       0.61      0.336\n",
      "                Person        114        166      0.845      0.681      0.763      0.437\n",
      "           Safety Cone        114         44      0.764      0.818      0.818      0.468\n",
      "           Safety Vest        114         41      0.742      0.732      0.733      0.419\n",
      "             machinery        114         55      0.674        0.8      0.823      0.477\n",
      "               vehicle        114         42      0.753      0.436      0.528      0.259\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      29/50      12.7G     0.9873     0.9931      1.197        250        640: 100% 163/163 [02:16<00:00,  1.20it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.80it/s]\n",
      "                   all        114        697      0.816      0.669      0.713      0.394\n",
      "               Hardhat        114         79      0.957      0.658       0.79      0.486\n",
      "                  Mask        114         21          1      0.799      0.824      0.523\n",
      "            NO-Hardhat        114         69      0.843      0.543      0.626      0.311\n",
      "               NO-Mask        114         74      0.769      0.514      0.559      0.261\n",
      "        NO-Safety Vest        114        106      0.809      0.558      0.632      0.313\n",
      "                Person        114        166      0.829      0.693      0.771      0.429\n",
      "           Safety Cone        114         44      0.844      0.818      0.821      0.393\n",
      "           Safety Vest        114         41      0.773      0.732      0.768      0.436\n",
      "             machinery        114         55      0.778      0.873      0.857      0.511\n",
      "               vehicle        114         42      0.559        0.5      0.478      0.277\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      30/50      12.7G     0.9839     0.9769      1.191        299        640: 100% 163/163 [02:19<00:00,  1.17it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.65it/s]\n",
      "                   all        114        697      0.793      0.669      0.718      0.411\n",
      "               Hardhat        114         79      0.879      0.671      0.761      0.484\n",
      "                  Mask        114         21       0.96      0.857      0.878      0.583\n",
      "            NO-Hardhat        114         69      0.736      0.536       0.58       0.28\n",
      "               NO-Mask        114         74      0.802      0.548      0.599      0.288\n",
      "        NO-Safety Vest        114        106      0.833      0.585      0.673      0.375\n",
      "                Person        114        166      0.799      0.675      0.778      0.446\n",
      "           Safety Cone        114         44      0.867      0.864      0.875      0.408\n",
      "           Safety Vest        114         41      0.725      0.706      0.726      0.447\n",
      "             machinery        114         55      0.679        0.8      0.807      0.527\n",
      "               vehicle        114         42      0.655      0.453      0.508      0.277\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      31/50      12.7G     0.9796     0.9787       1.19        290        640: 100% 163/163 [02:16<00:00,  1.19it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.64it/s]\n",
      "                   all        114        697      0.786      0.667      0.712      0.382\n",
      "               Hardhat        114         79      0.945      0.657      0.765      0.451\n",
      "                  Mask        114         21      0.834       0.81      0.842       0.47\n",
      "            NO-Hardhat        114         69      0.745      0.522      0.558      0.269\n",
      "               NO-Mask        114         74      0.794      0.541      0.594      0.273\n",
      "        NO-Safety Vest        114        106      0.846       0.57       0.69      0.359\n",
      "                Person        114        166      0.844      0.687      0.776      0.409\n",
      "           Safety Cone        114         44       0.81      0.795      0.804      0.426\n",
      "           Safety Vest        114         41      0.809      0.732      0.804      0.456\n",
      "             machinery        114         55      0.707      0.855      0.821      0.458\n",
      "               vehicle        114         42      0.529        0.5       0.46      0.245\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      32/50      12.7G     0.9753     0.9592       1.18        248        640: 100% 163/163 [02:17<00:00,  1.19it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.57it/s]\n",
      "                   all        114        697      0.819      0.663      0.732      0.405\n",
      "               Hardhat        114         79      0.921      0.709      0.804      0.482\n",
      "                  Mask        114         21      0.925      0.857       0.87      0.478\n",
      "            NO-Hardhat        114         69      0.707      0.493      0.564      0.243\n",
      "               NO-Mask        114         74      0.863      0.473      0.599       0.29\n",
      "        NO-Safety Vest        114        106       0.84      0.623      0.663       0.35\n",
      "                Person        114        166      0.788      0.681      0.762      0.441\n",
      "           Safety Cone        114         44      0.782      0.795      0.831      0.458\n",
      "           Safety Vest        114         41      0.784      0.709      0.817      0.488\n",
      "             machinery        114         55       0.79      0.818      0.859      0.521\n",
      "               vehicle        114         42      0.787      0.476      0.551      0.297\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      33/50      12.7G       0.96      0.947      1.177        261        640: 100% 163/163 [02:18<00:00,  1.17it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:03<00:00,  1.22it/s]\n",
      "                   all        114        697      0.851      0.669      0.745      0.423\n",
      "               Hardhat        114         79      0.889      0.759      0.831      0.524\n",
      "                  Mask        114         21      0.949      0.857        0.9      0.542\n",
      "            NO-Hardhat        114         69      0.948      0.531      0.642      0.296\n",
      "               NO-Mask        114         74      0.798      0.541       0.58       0.29\n",
      "        NO-Safety Vest        114        106      0.881      0.632      0.718      0.392\n",
      "                Person        114        166      0.852      0.699       0.78      0.429\n",
      "           Safety Cone        114         44      0.825      0.751      0.846      0.452\n",
      "           Safety Vest        114         41      0.853      0.707      0.811      0.479\n",
      "             machinery        114         55       0.75      0.836      0.842      0.505\n",
      "               vehicle        114         42      0.764      0.381      0.503      0.318\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      34/50      12.7G     0.9587     0.9284      1.171        184        640: 100% 163/163 [02:15<00:00,  1.20it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:03<00:00,  1.21it/s]\n",
      "                   all        114        697      0.853      0.651      0.732      0.413\n",
      "               Hardhat        114         79      0.964      0.687      0.795      0.488\n",
      "                  Mask        114         21          1      0.841      0.902      0.556\n",
      "            NO-Hardhat        114         69      0.921      0.522      0.597      0.284\n",
      "               NO-Mask        114         74      0.815      0.514      0.576      0.294\n",
      "        NO-Safety Vest        114        106       0.88      0.575      0.703      0.383\n",
      "                Person        114        166      0.869      0.699      0.774       0.43\n",
      "           Safety Cone        114         44      0.841      0.773      0.845      0.409\n",
      "           Safety Vest        114         41      0.767      0.707      0.758      0.456\n",
      "             machinery        114         55      0.845      0.796      0.859      0.524\n",
      "               vehicle        114         42      0.623      0.393      0.511      0.302\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      35/50      12.7G     0.9488     0.9169      1.166        338        640: 100% 163/163 [02:16<00:00,  1.20it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:03<00:00,  1.17it/s]\n",
      "                   all        114        697       0.82      0.695      0.746       0.42\n",
      "               Hardhat        114         79      0.929       0.66      0.787      0.484\n",
      "                  Mask        114         21      0.921       0.81      0.852      0.548\n",
      "            NO-Hardhat        114         69       0.89       0.58      0.681      0.335\n",
      "               NO-Mask        114         74      0.836      0.527      0.604      0.291\n",
      "        NO-Safety Vest        114        106      0.841      0.649      0.724      0.379\n",
      "                Person        114        166      0.845      0.681      0.775      0.417\n",
      "           Safety Cone        114         44      0.842      0.864      0.859      0.436\n",
      "           Safety Vest        114         41      0.811       0.78      0.826      0.506\n",
      "             machinery        114         55      0.726      0.855       0.83      0.525\n",
      "               vehicle        114         42      0.563      0.548      0.518      0.282\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      36/50      12.7G     0.9395     0.9059      1.164        281        640: 100% 163/163 [02:19<00:00,  1.17it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.71it/s]\n",
      "                   all        114        697      0.841      0.683       0.75      0.429\n",
      "               Hardhat        114         79      0.922      0.696      0.797      0.506\n",
      "                  Mask        114         21      0.936       0.81      0.861      0.496\n",
      "            NO-Hardhat        114         69      0.883      0.545      0.664      0.302\n",
      "               NO-Mask        114         74      0.811      0.541      0.611      0.298\n",
      "        NO-Safety Vest        114        106      0.843      0.623      0.707      0.389\n",
      "                Person        114        166      0.846      0.698      0.789      0.444\n",
      "           Safety Cone        114         44      0.902      0.886      0.892      0.505\n",
      "           Safety Vest        114         41      0.793      0.732      0.802      0.509\n",
      "             machinery        114         55      0.808      0.873      0.895      0.545\n",
      "               vehicle        114         42      0.662      0.429      0.483      0.301\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      37/50      12.7G     0.9375     0.8964      1.158        258        640: 100% 163/163 [02:18<00:00,  1.18it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.83it/s]\n",
      "                   all        114        697      0.864      0.679      0.758      0.446\n",
      "               Hardhat        114         79      0.928      0.722      0.792      0.507\n",
      "                  Mask        114         21      0.974      0.857      0.891      0.568\n",
      "            NO-Hardhat        114         69      0.846      0.555      0.666      0.318\n",
      "               NO-Mask        114         74      0.855      0.558      0.637      0.313\n",
      "        NO-Safety Vest        114        106      0.927      0.598      0.737      0.419\n",
      "                Person        114        166      0.861      0.693      0.792      0.464\n",
      "           Safety Cone        114         44      0.882      0.818      0.862      0.481\n",
      "           Safety Vest        114         41      0.796      0.732      0.816      0.522\n",
      "             machinery        114         55      0.801      0.803      0.863       0.56\n",
      "               vehicle        114         42      0.767      0.452      0.524      0.305\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      38/50      12.7G     0.9236     0.8805      1.154        340        640: 100% 163/163 [02:19<00:00,  1.17it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.71it/s]\n",
      "                   all        114        697      0.852      0.679       0.75      0.426\n",
      "               Hardhat        114         79      0.963      0.665      0.808      0.517\n",
      "                  Mask        114         21      0.977      0.857      0.902      0.546\n",
      "            NO-Hardhat        114         69       0.77      0.534      0.621      0.291\n",
      "               NO-Mask        114         74      0.852      0.541      0.615      0.284\n",
      "        NO-Safety Vest        114        106      0.896      0.571      0.723      0.373\n",
      "                Person        114        166      0.884      0.699      0.782      0.453\n",
      "           Safety Cone        114         44      0.854      0.864      0.891      0.497\n",
      "           Safety Vest        114         41      0.746       0.78      0.785      0.477\n",
      "             machinery        114         55      0.792       0.83      0.851      0.521\n",
      "               vehicle        114         42      0.786      0.452      0.519      0.302\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      39/50      12.7G     0.9256     0.8815      1.153        284        640: 100% 163/163 [02:16<00:00,  1.20it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.83it/s]\n",
      "                   all        114        697      0.822      0.668       0.74      0.434\n",
      "               Hardhat        114         79      0.912      0.684       0.79      0.486\n",
      "                  Mask        114         21      0.985      0.857      0.904      0.613\n",
      "            NO-Hardhat        114         69      0.817      0.522      0.621       0.33\n",
      "               NO-Mask        114         74      0.869      0.514      0.598      0.284\n",
      "        NO-Safety Vest        114        106      0.906      0.557      0.701      0.406\n",
      "                Person        114        166      0.841      0.687      0.783      0.456\n",
      "           Safety Cone        114         44      0.808      0.864      0.874      0.469\n",
      "           Safety Vest        114         41      0.773      0.659      0.777      0.457\n",
      "             machinery        114         55       0.74      0.818      0.859       0.53\n",
      "               vehicle        114         42      0.572      0.524      0.494       0.31\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      40/50      12.7G     0.9088     0.8659      1.145        302        640: 100% 163/163 [02:17<00:00,  1.19it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.80it/s]\n",
      "                   all        114        697      0.852      0.686      0.754      0.417\n",
      "               Hardhat        114         79      0.939      0.696      0.809      0.491\n",
      "                  Mask        114         21      0.979      0.857        0.9       0.52\n",
      "            NO-Hardhat        114         69      0.864      0.551      0.648      0.304\n",
      "               NO-Mask        114         74      0.835      0.545      0.629      0.297\n",
      "        NO-Safety Vest        114        106      0.879      0.604      0.708      0.377\n",
      "                Person        114        166       0.83      0.699      0.779      0.398\n",
      "           Safety Cone        114         44      0.868      0.841      0.875      0.471\n",
      "           Safety Vest        114         41      0.815      0.732      0.828      0.495\n",
      "             machinery        114         55      0.793      0.836      0.853      0.517\n",
      "               vehicle        114         42      0.716        0.5       0.51      0.298\n",
      "Closing dataloader mosaic\n",
      "\u001b[34m\u001b[1malbumentations: \u001b[0mBlur(p=0.01, blur_limit=(3, 7)), MedianBlur(p=0.01, blur_limit=(3, 7)), ToGray(p=0.01), CLAHE(p=0.01, clip_limit=(1, 4.0), tile_grid_size=(8, 8))\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      41/50      12.7G     0.9414     0.8208      1.164        195        640: 100% 163/163 [01:18<00:00,  2.07it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.56it/s]\n",
      "                   all        114        697      0.843      0.695      0.758      0.431\n",
      "               Hardhat        114         79      0.949      0.709      0.831       0.51\n",
      "                  Mask        114         21      0.875       0.81      0.876      0.556\n",
      "            NO-Hardhat        114         69      0.883      0.594      0.665       0.29\n",
      "               NO-Mask        114         74      0.842      0.554      0.659      0.313\n",
      "        NO-Safety Vest        114        106       0.91      0.623      0.733      0.416\n",
      "                Person        114        166       0.85      0.729      0.791      0.452\n",
      "           Safety Cone        114         44      0.866      0.841      0.884       0.47\n",
      "           Safety Vest        114         41      0.773      0.805      0.783      0.477\n",
      "             machinery        114         55      0.867      0.836      0.871      0.557\n",
      "               vehicle        114         42      0.611      0.449      0.484      0.271\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      42/50      12.7G     0.9258     0.7886      1.158        224        640: 100% 163/163 [01:13<00:00,  2.22it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.83it/s]\n",
      "                   all        114        697      0.867       0.68      0.756      0.445\n",
      "               Hardhat        114         79      0.967      0.733      0.825      0.513\n",
      "                  Mask        114         21      0.962      0.857      0.905      0.579\n",
      "            NO-Hardhat        114         69      0.833      0.536      0.643       0.34\n",
      "               NO-Mask        114         74      0.785      0.541      0.618       0.31\n",
      "        NO-Safety Vest        114        106      0.877      0.608      0.698      0.414\n",
      "                Person        114        166      0.879      0.693      0.773      0.452\n",
      "           Safety Cone        114         44      0.889      0.818      0.844      0.444\n",
      "           Safety Vest        114         41      0.864      0.772      0.825      0.494\n",
      "             machinery        114         55      0.891      0.836      0.895      0.579\n",
      "               vehicle        114         42      0.727      0.405      0.537      0.323\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      43/50      12.7G     0.9113     0.7689      1.143        201        640: 100% 163/163 [01:12<00:00,  2.24it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.78it/s]\n",
      "                   all        114        697      0.843      0.687       0.75      0.443\n",
      "               Hardhat        114         79      0.924      0.696      0.798      0.499\n",
      "                  Mask        114         21      0.923       0.81      0.876       0.62\n",
      "            NO-Hardhat        114         69      0.835      0.585      0.654      0.328\n",
      "               NO-Mask        114         74      0.887      0.532       0.62      0.296\n",
      "        NO-Safety Vest        114        106      0.906      0.642      0.743      0.434\n",
      "                Person        114        166      0.808      0.717      0.784      0.441\n",
      "           Safety Cone        114         44      0.849      0.841      0.847       0.47\n",
      "           Safety Vest        114         41      0.782      0.756      0.804      0.505\n",
      "             machinery        114         55      0.786      0.836       0.87      0.528\n",
      "               vehicle        114         42       0.73      0.452      0.508      0.307\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      44/50      12.7G     0.9061     0.7603       1.14        166        640: 100% 163/163 [01:12<00:00,  2.24it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:03<00:00,  1.21it/s]\n",
      "                   all        114        697      0.879      0.681       0.76      0.455\n",
      "               Hardhat        114         79      0.965      0.694      0.825      0.516\n",
      "                  Mask        114         21      0.971      0.857      0.903        0.6\n",
      "            NO-Hardhat        114         69      0.925      0.565      0.674      0.339\n",
      "               NO-Mask        114         74      0.896      0.541      0.645      0.319\n",
      "        NO-Safety Vest        114        106        0.9      0.604      0.738      0.422\n",
      "                Person        114        166      0.881      0.693      0.782      0.462\n",
      "           Safety Cone        114         44      0.894      0.841       0.86       0.48\n",
      "           Safety Vest        114         41      0.823      0.707       0.78      0.525\n",
      "             machinery        114         55      0.814      0.855      0.872      0.565\n",
      "               vehicle        114         42      0.723      0.452      0.518      0.321\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      45/50      12.7G     0.8902     0.7421      1.129        191        640: 100% 163/163 [01:12<00:00,  2.24it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.81it/s]\n",
      "                   all        114        697      0.889      0.683      0.759      0.464\n",
      "               Hardhat        114         79      0.926      0.709      0.851      0.533\n",
      "                  Mask        114         21      0.996      0.857      0.909      0.643\n",
      "            NO-Hardhat        114         69      0.929       0.57      0.669      0.356\n",
      "               NO-Mask        114         74      0.914      0.514      0.618      0.315\n",
      "        NO-Safety Vest        114        106      0.879      0.615      0.729      0.414\n",
      "                Person        114        166      0.866      0.693      0.783      0.473\n",
      "           Safety Cone        114         44      0.911      0.864      0.883      0.505\n",
      "           Safety Vest        114         41      0.838      0.756      0.769      0.519\n",
      "             machinery        114         55      0.848      0.809       0.88      0.574\n",
      "               vehicle        114         42      0.788      0.441        0.5      0.313\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      46/50      12.7G     0.8828     0.7312      1.125        150        640: 100% 163/163 [01:15<00:00,  2.16it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.77it/s]\n",
      "                   all        114        697      0.905      0.682      0.773      0.469\n",
      "               Hardhat        114         79      0.928      0.696       0.84      0.539\n",
      "                  Mask        114         21      0.966      0.857      0.901      0.655\n",
      "            NO-Hardhat        114         69      0.927       0.55      0.695      0.358\n",
      "               NO-Mask        114         74      0.975      0.521      0.651      0.328\n",
      "        NO-Safety Vest        114        106      0.929      0.594      0.713      0.424\n",
      "                Person        114        166      0.867      0.681      0.781      0.469\n",
      "           Safety Cone        114         44       0.92      0.864      0.887      0.473\n",
      "           Safety Vest        114         41      0.847       0.78      0.839      0.539\n",
      "             machinery        114         55      0.877      0.855       0.88      0.593\n",
      "               vehicle        114         42      0.815      0.419      0.546      0.317\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      47/50      12.7G     0.8694      0.718      1.115        123        640: 100% 163/163 [01:12<00:00,  2.23it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:03<00:00,  1.28it/s]\n",
      "                   all        114        697      0.847      0.719      0.775      0.457\n",
      "               Hardhat        114         79      0.954      0.747       0.85      0.511\n",
      "                  Mask        114         21      0.898      0.905      0.908       0.61\n",
      "            NO-Hardhat        114         69      0.873       0.58      0.698      0.329\n",
      "               NO-Mask        114         74      0.824      0.595       0.65      0.316\n",
      "        NO-Safety Vest        114        106      0.896      0.652      0.759      0.434\n",
      "                Person        114        166      0.843      0.705      0.796      0.474\n",
      "           Safety Cone        114         44      0.853      0.864      0.892      0.504\n",
      "           Safety Vest        114         41      0.761      0.756      0.758      0.492\n",
      "             machinery        114         55      0.883      0.873      0.894      0.567\n",
      "               vehicle        114         42      0.685      0.518      0.542      0.334\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      48/50      12.7G     0.8639     0.7081      1.112        155        640: 100% 163/163 [01:13<00:00,  2.22it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.81it/s]\n",
      "                   all        114        697      0.879      0.697      0.776      0.475\n",
      "               Hardhat        114         79      0.966       0.72      0.854      0.535\n",
      "                  Mask        114         21      0.957      0.857      0.913      0.633\n",
      "            NO-Hardhat        114         69      0.888      0.575      0.698      0.343\n",
      "               NO-Mask        114         74      0.895      0.527      0.623      0.328\n",
      "        NO-Safety Vest        114        106      0.935      0.623      0.749      0.437\n",
      "                Person        114        166       0.86      0.705      0.806      0.483\n",
      "           Safety Cone        114         44      0.842      0.864      0.886       0.51\n",
      "           Safety Vest        114         41      0.837       0.78      0.807      0.535\n",
      "             machinery        114         55        0.9      0.891      0.918       0.61\n",
      "               vehicle        114         42      0.711      0.429       0.51      0.337\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      49/50      12.7G     0.8504     0.6979      1.105        189        640: 100% 163/163 [01:13<00:00,  2.23it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:02<00:00,  1.51it/s]\n",
      "                   all        114        697      0.864      0.708      0.776      0.469\n",
      "               Hardhat        114         79      0.937      0.755      0.845      0.528\n",
      "                  Mask        114         21      0.969      0.857      0.905      0.626\n",
      "            NO-Hardhat        114         69      0.908      0.569        0.7       0.35\n",
      "               NO-Mask        114         74      0.878      0.554      0.641      0.323\n",
      "        NO-Safety Vest        114        106      0.919      0.632      0.736      0.434\n",
      "                Person        114        166      0.828      0.717      0.786      0.482\n",
      "           Safety Cone        114         44      0.854      0.886       0.89      0.497\n",
      "           Safety Vest        114         41        0.8       0.78      0.817      0.513\n",
      "             machinery        114         55      0.887      0.873       0.91        0.6\n",
      "               vehicle        114         42      0.656      0.455       0.53      0.333\n",
      "\n",
      "      Epoch    GPU_mem   box_loss   cls_loss   dfl_loss  Instances       Size\n",
      "      50/50      12.7G     0.8466     0.6986      1.105        173        640: 100% 163/163 [01:15<00:00,  2.16it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:06<00:00,  1.53s/it]\n",
      "                   all        114        697      0.926      0.689      0.785      0.477\n",
      "               Hardhat        114         79      0.966      0.712      0.845      0.534\n",
      "                  Mask        114         21      0.974      0.857      0.911      0.642\n",
      "            NO-Hardhat        114         69      0.952      0.575      0.699      0.342\n",
      "               NO-Mask        114         74          1      0.524      0.649      0.335\n",
      "        NO-Safety Vest        114        106      0.924      0.585       0.75      0.436\n",
      "                Person        114        166      0.885      0.687      0.806      0.484\n",
      "           Safety Cone        114         44      0.909      0.864      0.896      0.494\n",
      "           Safety Vest        114         41      0.884      0.743      0.833      0.549\n",
      "             machinery        114         55      0.943      0.873      0.909      0.608\n",
      "               vehicle        114         42      0.822      0.476      0.552      0.341\n",
      "\n",
      "50 epochs completed in 1.817 hours.\n",
      "Optimizer stripped from runs/detect/train/weights/last.pt, 6.2MB\n",
      "Optimizer stripped from runs/detect/train/weights/best.pt, 6.2MB\n",
      "\n",
      "Validating runs/detect/train/weights/best.pt...\n",
      "Ultralytics YOLOv8.0.20 ðŸš€ Python-3.10.12 torch-2.1.0+cu118 CUDA:0 (Tesla T4, 15102MiB)\n",
      "Model summary (fused): 168 layers, 3007598 parameters, 0 gradients, 8.1 GFLOPs\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100% 4/4 [00:06<00:00,  1.51s/it]\n",
      "                   all        114        697      0.926       0.69      0.785      0.476\n",
      "               Hardhat        114         79      0.966      0.711      0.845      0.534\n",
      "                  Mask        114         21      0.974      0.857      0.911      0.643\n",
      "            NO-Hardhat        114         69      0.952      0.575      0.699      0.343\n",
      "               NO-Mask        114         74          1      0.524      0.649      0.335\n",
      "        NO-Safety Vest        114        106      0.924      0.585       0.75      0.437\n",
      "                Person        114        166      0.885      0.687      0.807      0.486\n",
      "           Safety Cone        114         44      0.909      0.864      0.897      0.493\n",
      "           Safety Vest        114         41      0.884      0.743      0.833      0.549\n",
      "             machinery        114         55      0.943      0.873      0.909      0.604\n",
      "               vehicle        114         42      0.822      0.476      0.552      0.341\n",
      "Speed: 0.5ms pre-process, 3.2ms inference, 0.0ms loss, 6.0ms post-process per image\n",
      "Results saved to \u001b[1mruns/detect/train\u001b[0m\n"
     ]
    }
   ],
   "source": [
    "!yolo task=detect mode=train epochs=50 data='/content/drive/MyDrive/Worker_safety_Data/safety.yaml' model=yolov8n.pt imgsz=640 patience=10"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "colab": {
     "base_uri": "https://localhost:8080/"
    },
    "id": "JIiVuOvltNwt",
    "outputId": "37927d5f-b90f-4003-eccf-b7164a63fa90"
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Ultralytics YOLOv8.0.20 ðŸš€ Python-3.10.12 torch-2.1.0+cu118 CUDA:0 (Tesla T4, 15102MiB)\n",
      "Model summary (fused): 168 layers, 3007598 parameters, 0 gradients, 8.1 GFLOPs\n",
      "\u001b[34m\u001b[1mval: \u001b[0mScanning /content/drive/MyDrive/Worker_safety_Data/Worker_safety_detection/valid/labels.cache... 114 images, 10 backgrounds, 0 corrupt: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 114/114 [00:00<?, ?it/s]\n",
      "                 Class     Images  Instances      Box(P          R      mAP50  mAP50-95): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:08<00:00,  1.03s/it]\n",
      "                   all        114        697      0.919      0.688      0.782      0.476\n",
      "               Hardhat        114         79      0.958      0.709      0.844      0.536\n",
      "                  Mask        114         21      0.974      0.857      0.911      0.644\n",
      "            NO-Hardhat        114         69      0.952      0.575      0.699      0.341\n",
      "               NO-Mask        114         74      0.974       0.51      0.624      0.329\n",
      "        NO-Safety Vest        114        106      0.925      0.585      0.751       0.44\n",
      "                Person        114        166      0.885      0.687      0.806      0.486\n",
      "           Safety Cone        114         44       0.91      0.864      0.897      0.496\n",
      "           Safety Vest        114         41      0.884      0.743      0.833      0.546\n",
      "             machinery        114         55      0.943      0.873      0.909      0.606\n",
      "               vehicle        114         42      0.789      0.476       0.55      0.339\n",
      "Speed: 6.3ms pre-process, 8.4ms inference, 0.0ms loss, 5.4ms post-process per image\n"
     ]
    }
   ],
   "source": [
    "from ultralytics import YOLO\n",
    "model=YOLO('/content/runs/detect/train/weights/best.pt')\n",
    "metrics = model.val()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {
    "id": "naXvaVGTvCnb"
   },
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "accelerator": "GPU",
  "colab": {
   "gpuType": "T4",
   "provenance": []
  },
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
